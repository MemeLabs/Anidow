<UserControl
    d:DataContext="{d:DesignInstance tracked:TrackedAnimeEditContentViewModel}"
    d:DesignHeight="450"
    d:DesignWidth="800"
    mc:Ignorable="d"
    x:Class="Anidow.Pages.Components.Tracked.TrackedAnimeEditContentView"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:adonisUI="clr-namespace:AdonisUI;assembly=AdonisUI"
    xmlns:converters="clr-namespace:Anidow.Converters"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:enums="clr-namespace:Anidow.Enums"
    xmlns:extensions="clr-namespace:AdonisUI.Extensions;assembly=AdonisUI"
    xmlns:extensions1="clr-namespace:Anidow.Extensions"
    xmlns:iconPacks="http://metro.mahapps.com/winfx/xaml/iconpacks"
    xmlns:listViewLayout="clr-namespace:Itenso.Windows.Controls.ListViewLayout;assembly=Itenso.Windows.Controls.ListViewLayout"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:models="clr-namespace:Anidow.Database.Models"
    xmlns:s="https://github.com/canton7/Stylet"
    xmlns:system="clr-namespace:System;assembly=System.Runtime"
    xmlns:tracked="clr-namespace:Anidow.Pages.Components.Tracked"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>
        <Border
            Background="{DynamicResource {x:Static adonisUI:Brushes.AccentBrush}}"
            Grid.Row="0"
            Margin="4,2,4,8"
            Padding="4">

            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>

                <Button
                    Command="{s:Action Close}"
                    Content="{iconPacks:FontAwesome ArrowLeftSolid}"
                    Foreground="White"
                    HorizontalAlignment="Left"
                    Style="{DynamicResource {x:Static adonisUI:Styles.AccentToolbarButton}}"
                    ToolTip="Go back"
                    Width="50" />

                <TextBlock
                    FontWeight="SemiBold"
                    Foreground="White"
                    Grid.Column="1"
                    HorizontalAlignment="Center"
                    VerticalAlignment="Center">
                    Edit Anime
                </TextBlock>

                <TextBlock
                    Grid.Column="2"
                    HorizontalAlignment="Right"
                    Margin="8,0,4,0"
                    Text="{Binding Anime.Notification, Mode=OneWay}"
                    VerticalAlignment="Center" />

                <Button
                    Command="{s:Action SaveAnime,
                                       ActionNotFound=Disable}"
                    Content="Save"
                    Grid.Column="3"
                    Margin="4,0"
                    ToolTip="Save changes"
                    VerticalAlignment="Center" />

                <Button
                    Background="#F44336"
                    Command="{s:Action Delete,
                                       ActionNotFound=Disable}"
                    Content="Delete"
                    Foreground="White"
                    Grid.Column="4"
                    Margin="4,0,0,0"
                    VerticalAlignment="Center"
                    extensions:CursorSpotlightExtension.BackgroundBrush="#EF5350"
                    extensions:RippleExtension.BackgroundBrush="#EF5350" />
            </Grid>

        </Border>
        <ScrollViewer
            Grid.Row="1"
            VerticalScrollBarVisibility="Auto"
            extensions1:TouchScrolling.IsEnabled="True">
            <Grid Margin="2">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition MinWidth="160" Width="160" />
                    <ColumnDefinition Width="2" />
                    <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="*" />
                    <RowDefinition Height="Auto" />
                </Grid.RowDefinitions>


                <Image
                    Grid.Column="0"
                    Grid.Row="0"
                    Margin="4,0,4,8"
                    RenderOptions.BitmapScalingMode="HighQuality"
                    Source="{Binding Anime.CoverData.FilePath, IsAsync=True}"
                    VerticalAlignment="Top"
                    Visibility="{Binding Anime.CoverData.File, Converter={x:Static converters:IsNullToVisibilityConverter.Instance}}" />

                <GridSplitter
                    Grid.Column="1"
                    Grid.Row="0"
                    VerticalAlignment="Stretch"
                    Width="2" />

                <Border
                    Background="{DynamicResource {x:Static adonisUI:Brushes.Layer1BackgroundBrush}}"
                    CornerRadius="4"
                    Grid.Column="2"
                    Grid.Row="0"
                    Margin="4,0,4,8"
                    Padding="4"
                    extensions:LayerExtension.IncreaseLayer="True">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition />
                            <ColumnDefinition />
                            <ColumnDefinition />
                        </Grid.ColumnDefinitions>
                        <TextBlock
                            FontSize="16"
                            FontWeight="SemiBold"
                            Grid.ColumnSpan="3"
                            Margin="4"
                            Text="{Binding Anime.Name}"
                            TextWrapping="Wrap" />
                        <Separator
                            Grid.Column="0"
                            Grid.ColumnSpan="3"
                            Grid.Row="1" />

                        <Grid
                            Grid.Column="0"
                            Grid.Row="2"
                            Margin="4">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>
                            <TextBlock Margin="0,0,0,4" Text="Status:" />
                            <ComboBox Grid.Row="1" SelectedItem="{Binding Anime.Status, Mode=TwoWay}">
                                <enums:AnimeStatus>Watching</enums:AnimeStatus>
                                <enums:AnimeStatus>Completed</enums:AnimeStatus>
                                <enums:AnimeStatus>Dropped</enums:AnimeStatus>
                            </ComboBox>
                        </Grid>

                        <Grid
                            Grid.Column="1"
                            Grid.Row="2"
                            IsEnabled="False"
                            Margin="4"
                            Opacity=".3">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>
                            <TextBlock Margin="0,0,0,4" Text="Score:" />
                            <ComboBox
                                Grid.Row="1"
                                SelectedItem="{Binding Anime.Score, Mode=TwoWay}"
                                extensions:LayerExtension.Layer="2">
                                <system:Int16>1</system:Int16>
                                <system:Int16>2</system:Int16>
                                <system:Int16>3</system:Int16>
                                <system:Int16>4</system:Int16>
                                <system:Int16>5</system:Int16>
                                <system:Int16>6</system:Int16>
                                <system:Int16>7</system:Int16>
                                <system:Int16>8</system:Int16>
                                <system:Int16>9</system:Int16>
                                <system:Int16>10</system:Int16>
                            </ComboBox>

                        </Grid>

                        <Grid
                            Grid.Column="0"
                            Grid.Row="3"
                            Margin="4">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>
                            <TextBlock Margin="0,0,0,4" Text="Date added:" />
                            <DatePicker Grid.Row="1" Text="{Binding Anime.Created, Mode=TwoWay}" />
                        </Grid>

                        <Grid
                            Grid.Column="1"
                            Grid.Row="3"
                            Margin="4">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>
                            <TextBlock Margin="0,0,0,4" Text="Resolution:" />
                            <ComboBox Grid.Row="1" SelectedItem="{Binding Anime.Resolution, Mode=TwoWay}">
                                <system:String>720p</system:String>
                                <system:String>1080p</system:String>
                            </ComboBox>
                        </Grid>
                        <Grid
                            Grid.Column="0"
                            Grid.ColumnSpan="3"
                            Grid.Row="4"
                            Margin="4">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>
                            <TextBlock Margin="0,0,0,4" Text="Group:" />
                            <TextBox Grid.Row="1"
                                     Text="{Binding Anime.Group, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                        </Grid>
                    </Grid>
                </Border>

                <Grid
                    Grid.Column="0"
                    Grid.ColumnSpan="3"
                    Grid.Row="1"
                    Margin="4">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="*" />
                    </Grid.RowDefinitions>
                    <TextBlock
                        FontWeight="Bold"
                        Margin="4,0,4,4"
                        Text="Folder:"
                        VerticalAlignment="Center" />

                    <Grid Grid.Row="1">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="Auto" />
                        </Grid.ColumnDefinitions>
                        <TextBox
                            IsReadOnly="True"
                            Text="{Binding Anime.Folder}"
                            TextAlignment="Left"
                            TextWrapping="Wrap" />

                        <Button
                            Command="{s:Action OpenFolderBrowserDialog,
                                               ActionNotFound=Disable}"
                            Content="{iconPacks:FontAwesome FolderPlusSolid}"
                            Grid.Column="1"
                            Margin="8,0,8,0"
                            ToolTip="Set new folder" />

                        <Button
                            Command="{s:Action OpenFolderFilesWindow,
                                               ActionNotFound=Disable}"
                            Content="{iconPacks:FontAwesome FolderOpenSolid}"
                            Grid.Column="2"
                            ToolTip="Open folder" />
                    </Grid>

                    <Expander
                        Grid.Row="2"
                        Header="{Binding Anime.Episodes}"
                        HeaderStringFormat="{}{0} Episodes"
                        Margin="0,8"
                        Style="{StaticResource ExpanderCustom}"
                        extensions:LayerExtension.IncreaseLayer="True">
                        <ListView
                            ItemContainerStyle="{StaticResource ListViewItemBase}"
                            ItemsSource="{Binding Anime.EpisodeList, Mode=OneWay}"
                            extensions:GridViewSortExtension.AutoSort="True"
                            listViewLayout:ListViewLayoutManager.Enabled="true">
                            <ListView.View>
                                <GridView>
                                    <GridViewColumn
                                        Header="Name"
                                        HeaderContainerStyle="{StaticResource GridViewFirstCenteredContainerStyle}"
                                        extensions:GridViewSortExtension.PropertyName="Name"
                                        listViewLayout:RangeColumn.IsFillColumn="true">
                                        <GridViewColumn.CellTemplate>
                                            <DataTemplate DataType="models:Episode">
                                                <TextBlock
                                                    HorizontalAlignment="Stretch"
                                                    Margin="-10,0,0,0"
                                                    Text="{Binding Name}"
                                                    TextTrimming="CharacterEllipsis"
                                                    TextWrapping="NoWrap"
                                                    ToolTip="{Binding Name}"
                                                    ToolTipService.Placement="Bottom"
                                                    VerticalAlignment="Center" />
                                            </DataTemplate>
                                        </GridViewColumn.CellTemplate>
                                    </GridViewColumn>
                                    <GridViewColumn
                                        Header="Episode"
                                        HeaderContainerStyle="{StaticResource GridViewCenteredContainerStyle}"
                                        Width="85"
                                        extensions:GridViewSortExtension.PropertyName="EpisodeNum"
                                        listViewLayout:FixedColumn.Width="85">
                                        <GridViewColumn.CellTemplate>
                                            <DataTemplate DataType="models:Episode">
                                                <TextBlock
                                                    HorizontalAlignment="Left"
                                                    Margin="-12,0"
                                                    Text="{Binding EpisodeNum}"
                                                    TextAlignment="Center"
                                                    Width="78" />
                                            </DataTemplate>
                                        </GridViewColumn.CellTemplate>
                                    </GridViewColumn>
                                    <GridViewColumn
                                        CellTemplate="{DynamicResource WatchOpen}"
                                        HeaderContainerStyle="{StaticResource GridViewLastCenteredContainerStyle}"
                                        Width="70"
                                        listViewLayout:FixedColumn.Width="70" />
                                </GridView>
                            </ListView.View>
                        </ListView>

                    </Expander>
                </Grid>


            </Grid>
        </ScrollViewer>


    </Grid>


</UserControl>